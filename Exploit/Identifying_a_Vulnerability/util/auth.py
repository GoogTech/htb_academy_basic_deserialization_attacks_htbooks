import base64
import pickle
import types
import sys

# 伪造 util.auth.Session 所需模块和类
class Session:
    def __init__(self, username=None, role=None):
        self.username = username
        self.role = role
    def __repr__(self):
        return f"<MockSession username={self.username!r}, role={self.role!r}>"

# 构建伪模块结构
util = types.ModuleType("util")
auth = types.ModuleType("util.auth")
auth.Session = Session
util.auth = auth
sys.modules["util"] = util
sys.modules["util.auth"] = auth

# 解码 + 反序列化
cookie = "gASVSgAAAAAAAACMCXV0aWwuYXV0aJSMB1Nlc3Npb26Uk5QpgZR9lCiMCHVzZXJuYW1llIwNZnJhbnoubXVlbGxlcpSMBHJvbGWUjAR1c2VylHViLg=="
obj = pickle.loads(base64.b64decode(cookie))

print(obj)
print("username:", obj.username)
print("role:", obj.role)

# <MockSession username='franz.mueller', role='user'>
# username: franz.mueller
# role: user